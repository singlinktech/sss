# XrayR URL访问实时推送功能 - 简单说明

## 这是什么？

想象你有一个监控摄像头，可以实时看到谁进出你家。这个功能就像是给XrayR装了一个"监控摄像头"，可以实时看到用户访问了哪些网站。

## 为什么需要这个功能？

- **实时监控**：就像看直播一样，用户访问什么网站你立刻就知道
- **完整信息**：不仅知道访问了什么网站，还知道是谁、从哪里访问的
- **自动运行**：一旦配置好，就会自动工作，不需要额外操作

## 怎么使用？

### 第一步：修改配置文件

在你的XrayR配置文件中添加以下内容：

```yaml
URLLoggerConfig:
  Enable: true                    # 开启URL记录
  EnableRealtime: true            # 开启实时推送
  RealtimeAddr: "127.0.0.1:9999"  # 监听地址（就像开了一个窗口）
```

### 第二步：启动XrayR

正常启动XrayR，它会自动开启实时推送服务。

### 第三步：接收数据

运行Python客户端来接收数据：

```bash
python3 examples/realtime_client.py
```

## 看到什么？

当有用户访问网站时，你会看到类似这样的信息：

```
============================================================
[URL访问记录] 2024-07-14 12:00:15
用户邮箱: user@example.com
用户ID: 0
源IP: 192.168.1.100
访问域名: google.com
完整URL: https://google.com:443
协议: https
节点ID: 1
节点标签: node1
额外信息: level:0,tag:node1,network:tcp
============================================================
```

## 重要提示

1. **数据格式**：所有数据都是JSON格式，就像是一个标准的数据包
2. **端口号**：默认使用9999端口，确保这个端口没有被占用
3. **自动启动**：配置好后，每次启动XrayR都会自动启动实时推送
4. **多客户端**：可以同时有多个程序连接接收数据

## 示例场景

假设你想知道是否有用户访问了恶意网站：

1. 运行客户端程序接收数据
2. 当收到访问记录时，检查域名
3. 如果是恶意网站，立即发出警告

## 技术细节（给懂技术的人看）

- 使用TCP Socket通信
- JSON格式传输数据
- 包含心跳机制（每30秒）
- 非阻塞设计，不影响主程序性能
- 支持并发多客户端连接

## 常见问题

**Q: 为什么连接不上？**
A: 检查XrayR是否在运行，配置是否正确，端口是否被占用。

**Q: 没有收到数据？**
A: 确认有用户在使用代理，检查URL记录器是否启用。

**Q: 可以用其他语言接收吗？**
A: 可以！只要能连接TCP端口并解析JSON就行。文档中有Node.js和Go的示例。

## 总结

这个功能让你能实时知道用户在访问什么网站，就像给XrayR装了一双"眼睛"。配置简单，使用方便，而且不会影响原有功能。你可以用这些数据做很多事情：监控、分析、告警等等。 